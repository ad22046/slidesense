<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slide Sense - Intelligent Landslide Detection</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --danger: #ef4444;
            --warning: #f59e0b;
            --success: #10b981;
            --info: #3b82f6;
            --dark: #0f172a;
            --light: #f8fafc;
            --gray: #64748b;
            --border: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            overflow-x: hidden;
            background: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }

        /* Navbar Enhanced */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            padding: 1rem 0;
            border-bottom: 1px solid var(--border);
        }

        .navbar-brand {
            font-size: 1.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .navbar-brand i {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-link {
            color: var(--gray) !important;
            font-weight: 500;
            margin: 0 0.5rem;
            transition: all 0.3s ease;
            position: relative;
            font-size: 0.95rem;
        }

        .nav-link:hover {
            color: var(--primary) !important;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: width 0.3s ease;
        }

        .nav-link:hover::after {
            width: 100%;
        }

        .btn-login {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 0.6rem 1.8rem;
            border-radius: 50px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }

        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
        }

        /* Hero Section Enhanced */
        .hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 120px 0 80px;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            width: 600px;
            height: 600px;
            background: rgba(255,255,255,0.08);
            border-radius: 50%;
            top: -300px;
            right: -200px;
            animation: float 20s infinite ease-in-out;
        }

        .hero::after {
            content: '';
            position: absolute;
            width: 400px;
            height: 400px;
            background: rgba(255,255,255,0.05);
            border-radius: 50%;
            bottom: -200px;
            left: -100px;
            animation: float 15s infinite ease-in-out reverse;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }

        .hero h1 {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            line-height: 1.2;
            animation: fadeInUp 0.8s ease-out;
        }

        .hero p {
            font-size: 1.25rem;
            margin-bottom: 2.5rem;
            opacity: 0.95;
            animation: fadeInUp 1s ease-out;
        }

        .hero .btn {
            animation: fadeInUp 1.2s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Alert Banner Enhanced */
        .alert-banner {
            background: linear-gradient(135deg, var(--danger), #dc2626);
            color: white;
            padding: 1rem;
            text-align: center;
            animation: slideDown 0.5s ease-out, pulse 2s infinite;
            display: none;
            box-shadow: 0 4px 20px rgba(239, 68, 68, 0.3);
        }

        .alert-banner.active {
            display: block;
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); }
            to { transform: translateY(0); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.85; }
        }

        /* Cards Enhanced */
        .sensor-card {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }

        .sensor-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--primary);
            transition: width 0.3s ease;
        }

        .sensor-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.12);
        }

        .sensor-card:hover::before {
            width: 8px;
        }

        .sensor-card.danger::before {
            background: var(--danger);
        }

        .sensor-card.warning::before {
            background: var(--warning);
        }

        .sensor-card.danger {
            background: linear-gradient(135deg, #fef2f2, white);
            border-color: #fecaca;
        }

        .sensor-card.warning {
            background: linear-gradient(135deg, #fffbeb, white);
            border-color: #fde68a;
        }

        .sensor-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            opacity: 0.9;
        }

        .sensor-value {
            font-size: 2.5rem;
            font-weight: 800;
            margin: 0.5rem 0;
            line-height: 1;
        }

        .sensor-label {
            color: var(--gray);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        /* Risk Card Enhanced */
        .risk-card-main {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 24px;
            padding: 3rem;
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);
            margin-bottom: 3rem;
        }

        .risk-meter {
            width: 100%;
            height: 40px;
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
            position: relative;
            margin: 2rem 0;
            overflow: hidden;
        }

        .risk-meter-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), var(--warning), var(--danger));
            border-radius: 20px;
            transition: width 0.8s ease;
            position: relative;
        }

        .risk-indicator {
            position: absolute;
            width: 24px;
            height: 50px;
            background: white;
            border-radius: 6px;
            top: -5px;
            transition: left 0.8s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        /* Status Badge Enhanced */
        .status-badge {
            padding: 0.75rem 2rem;
            border-radius: 50px;
            font-weight: 700;
            display: inline-block;
            margin-top: 1rem;
            font-size: 0.95rem;
            letter-spacing: 0.5px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .status-safe {
            background: var(--success);
            color: white;
        }

        .status-warning {
            background: var(--warning);
            color: white;
        }

        .status-danger {
            background: var(--danger);
            color: white;
        }

        /* Chart Container Enhanced */
        .chart-container {
            background: white;
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            margin-bottom: 2rem;
            border: 1px solid var(--border);
        }

        /* Contact Card Enhanced */
        .contact-card {
            background: white;
            border-radius: 20px;
            padding: 1.8rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1.5rem;
            transition: all 0.3s ease;
            border: 1px solid var(--border);
        }

        .contact-card:hover {
            transform: translateX(8px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .contact-icon {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            width: 70px;
            height: 70px;
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            flex-shrink: 0;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }

        /* Resource Card Enhanced */
        .resource-card {
            background: white;
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
            border: 1px solid var(--border);
        }

        .resource-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.12);
        }

        .resource-card h4 {
            color: var(--primary);
            margin-bottom: 1.5rem;
            font-weight: 700;
        }

        .resource-card ul {
            list-style: none;
            padding-left: 0;
        }

        .resource-card li {
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: start;
            gap: 0.75rem;
        }

        .resource-card li:last-child {
            border-bottom: none;
        }

        .resource-card li:before {
            content: "âœ“";
            color: var(--success);
            font-weight: bold;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        /* Feature Box Enhanced */
        .feature-box {
            background: white;
            border-radius: 20px;
            padding: 2.5rem;
            text-align: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            transition: all 0.4s ease;
            margin-bottom: 2rem;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }

        .feature-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transform: scaleX(0);
            transition: transform 0.4s ease;
        }

        .feature-box:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .feature-box:hover::before {
            transform: scaleX(1);
        }

        .feature-icon {
            font-size: 3.5rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1.5rem;
        }

        .feature-box h4 {
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--dark);
        }

        /* Section Title Enhanced */
        .section-title {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 3rem;
            color: var(--dark);
            position: relative;
            padding-bottom: 1rem;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 80px;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 3px;
        }

        .section-title.center::after {
            left: 50%;
            transform: translateX(-50%);
        }

        /* Map Enhanced */
        #map {
            height: 500px;
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border: 1px solid var(--border);
        }

        /* Modal Enhanced */
        .modal-content {
            border-radius: 24px;
            border: none;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .modal-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 2rem;
        }

        .modal-body {
            padding: 2.5rem;
        }

        .form-control {
            border-radius: 12px;
            padding: 0.875rem 1rem;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .form-control:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }

        /* Button Enhancements */
        .btn {
            border-radius: 12px;
            padding: 0.875rem 1.75rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
        }

        .btn-danger {
            background: var(--danger);
            border: none;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
        }

        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
        }

        .btn-lg {
            padding: 1.25rem 2.5rem;
            font-size: 1.1rem;
        }

        /* Footer Enhanced */
        footer {
            background: var(--dark);
            color: rgba(255,255,255,0.8);
            padding: 4rem 0 2rem;
            margin-top: 5rem;
        }

        .footer-section h5 {
            color: white;
            margin-bottom: 1.5rem;
            font-weight: 700;
        }

        .footer-section a {
            color: rgba(255,255,255,0.7);
            text-decoration: none;
            transition: color 0.3s ease;
            display: block;
            padding: 0.3rem 0;
        }

        .footer-section a:hover {
            color: var(--primary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .hero p {
                font-size: 1.1rem;
            }

            .section-title {
                font-size: 2rem;
            }

            .sensor-value {
                font-size: 2rem;
            }

            .feature-box {
                margin-bottom: 1.5rem;
            }

            #map {
                height: 350px;
            }
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(99, 102, 241, 0.3);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Smooth Scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Section Spacing */
        section {
            padding: 5rem 0;
        }

        section:first-of-type {
            padding-top: 0;
        }
    </style>
</head>
<body>
    <div id="alertBanner" class="alert-banner">
        <div class="container">
            <strong><i class="fas fa-exclamation-triangle me-2"></i> LANDSLIDE ALERT!</strong>
            <span id="alertMessage" class="ms-2">High risk detected in your area. Please follow safety protocols.</span>
        </div>
    </div>

    <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container">
            <a class="navbar-brand" href="#" onclick="showSection('home')">
                <i class="fas fa-mountain"></i> Slide Sense
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-center">
                    <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('home')">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('dashboard')">Dashboard</a></li>
                    <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('emergency')">Emergency</a></li>
                    <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('preparedness')">Safety</a></li>
                    <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('location')">Location</a></li>
                    <li class="nav-item ms-2">
                        <button class="btn-login" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i class="fas fa-sign-in-alt me-2"></i>Login
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <section id="home" class="hero">
        <div class="container position-relative" style="z-index: 1;">
            <div class="row align-items-center">
                <div class="col-lg-7">
                    <h1>Intelligent Landslide Detection & Alert System</h1>
                    <p class="mb-4">Real-time IoT monitoring with AI-powered risk assessment. Stay safe with instant alerts and 24/7 environmental surveillance.</p>
                    <div class="d-flex gap-3 flex-wrap">
                        <button class="btn btn-light btn-lg" onclick="showSection('dashboard')">
                            <i class="fas fa-chart-line me-2"></i>View Dashboard
                        </button>
                        <button class="btn btn-outline-light btn-lg" onclick="showSection('emergency')">
                            <i class="fas fa-phone-alt me-2"></i>Emergency Help
                        </button>
                    </div>
                </div>
                <div class="col-lg-5 text-center mt-5 mt-lg-0">
                    <i class="fas fa-satellite-dish" style="font-size: 12rem; opacity: 0.15;"></i>
                </div>
            </div>
        </div>
    </section>

    <section id="features" class="bg-white">
        <div class="container">
            <h2 class="section-title center text-center">System Features</h2>
            <div class="row">
                <div class="col-md-6 col-lg-4">
                    <div class="feature-box">
                        <div class="feature-icon"><i class="fas fa-chart-line"></i></div>
                        <h4>Real-Time Monitoring</h4>
                        <p class="text-muted">7 advanced sensors continuously monitor environmental conditions 24/7 with millisecond precision</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="feature-box">
                        <div class="feature-icon"><i class="fas fa-bell"></i></div>
                        <h4>Instant Alerts</h4>
                        <p class="text-muted">Receive immediate email and SMS notifications the moment danger is detected in your area</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="feature-box">
                        <div class="feature-icon"><i class="fas fa-cloud"></i></div>
                        <h4>Cloud Analytics</h4>
                        <p class="text-muted">Data stored and analyzed in ThingSpeak cloud with comprehensive historical trend analysis</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="feature-box">
                        <div class="feature-icon"><i class="fas fa-map-marked-alt"></i></div>
                        <h4>GPS Tracking</h4>
                        <p class="text-muted">Real-time location monitoring with interactive mapping and safe zone identification</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="feature-box">
                        <div class="feature-icon"><i class="fas fa-brain"></i></div>
                        <h4>AI Risk Assessment</h4>
                        <p class="text-muted">Machine learning algorithms calculate multi-factor risk levels with 95% accuracy</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="feature-box">
                        <div class="feature-icon"><i class="fas fa-phone-volume"></i></div>
                        <h4>Emergency SOS</h4>
                        <p class="text-muted">One-click emergency alert directly to authorities and rescue services with your location</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="dashboard" style="display:none;">
        <div class="container">
            <h2 class="section-title">Real-Time Sensor Dashboard</h2>
            
            <div class="risk-card-main text-center">
                <h3 class="mb-3">Overall Risk Assessment</h3>
                <div class="risk-meter">
                    <div class="risk-meter-fill" id="riskMeterFill" style="width: 30%;">
                        <div class="risk-indicator" id="riskIndicator"></div>
                    </div>
                </div>
                <h1 id="riskLevel" class="display-4 fw-bold">Calculating...</h1>
                <span id="riskBadge" class="status-badge status-safe">SAFE</span>
                <p class="mt-3 mb-0 opacity-75" id="riskDescription">All parameters within normal range</p>
            </div>

            <div class="row g-4">
                <div class="col-md-6 col-lg-4">
                    <div class="sensor-card" id="soilCard">
                        <div class="sensor-icon text-primary">
                            <i class="fas fa-tint"></i>
                        </div>
                        <div class="sensor-label">Soil Moisture</div>
                        <div class="sensor-value text-primary" id="soilMoisture">--</div>
                        <small class="text-muted">Status: <span id="soilStatus" class="fw-bold">Loading...</span></small>
                    </div>
                </div>

                <div class="col-md-6 col-lg-4">
                    <div class="sensor-card" id="tempCard">
                        <div class="sensor-icon text-danger">
                            <i class="fas fa-thermometer-half"></i>
                        </div>
                        <div class="sensor-label">Temperature</div>
                        <div class="sensor-value text-danger" id="temperature">--</div>
                        <small class="text-muted">Humidity: <span id="humidity" class="fw-bold">--</span></small>
                    </div>
                </div>

                <div class="col-md-6 col-lg-4">
                    <div class="sensor-card" id="accelCard">
                        <div class="sensor-icon text-warning">
                            <i class="fas fa-wave-square"></i>
                        </div>
                        <div class="sensor-label">Acceleration</div>
                        <div class="sensor-value text-warning" id="acceleration">--</div>
                        <small class="text-muted">Status: <span id="accelStatus" class="fw-bold">Loading...</span></small>
                    </div>
                </div>

                <div class="col-md-6 col-lg-4">
                    <div class="sensor-card" id="gasCard">
                        <div class="sensor-icon text-info">
                            <i class="fas fa-smog"></i>
                        </div>
                        <div class="sensor-label">Gas Level</div>
                        <div class="sensor-value text-info" id="gasLevel">--</div>
                        <small class="text-muted">Status: <span id="gasStatus" class="fw-bold">Loading...</span></small>
                    </div>
                </div>

                <div class="col-md-6 col-lg-4">
                    <div class="sensor-card" id="distanceCard">
                        <div class="sensor-icon text-success">
                            <i class="fas fa-ruler"></i>
                        </div>
                        <div class="sensor-label">Distance</div>
                        <div class="sensor-value text-success" id="distance">--</div>
                        <small class="text-muted">Ultrasonic Sensor</small>
                    </div>
                </div>

                <div class="col-md-6 col-lg-4">
                    <div class="sensor-card" id="vibrationCard">
                        <div class="sensor-icon" style="color: #dc2626;">
                            <i class="fas fa-broadcast-tower"></i>
                        </div>
                        <div class="sensor-label">Vibration</div>
                        <div class="sensor-value" style="color: #dc2626;" id="vibration">--</div>
                        <small class="text-muted">Status: <span id="vibrationStatus" class="fw-bold">Loading...</span></small>
                    </div>
                </div>

                <div class="col-md-6 col-lg-4">
                    <div class="sensor-card" id="rainCard">
                        <div class="sensor-icon text-primary">
                            <i class="fas fa-cloud-rain"></i>
                        </div>
                        <div class="sensor-label">Rain Detection</div>
                        <div class="sensor-value text-primary" id="rainLevel">--</div>
                        <small class="text-muted">Status: <span id="rainStatus" class="fw-bold">Loading...</span></small>
                    </div>
                </div>
            </div>

            <div class="chart-container mt-5">
                <h4 class="mb-4"><i class="fas fa-chart-area me-2"></i>ThingSpeak Cloud Integration</h4>
                <p class="text-muted mb-4">Connect your ThingSpeak channel to visualize historical sensor data and trends</p>
                <div class="row g-3 mb-4">
                    <div class="col-md-5">
                        <input type="text" class="form-control" id="channelId" placeholder="Enter ThingSpeak Channel ID">
                    </div>
                    <div class="col-md-5">
                        <input type="text" class="form-control" id="readApiKey" placeholder="Enter Read API Key">
                    </div>
                    <div class="col-md-2">
                        <button class="btn btn-primary w-100" onclick="loadThingSpeakCharts()">
                            <i class="fas fa-sync me-2"></i>Load
                        </button>
                    </div>
                </div>
                <div id="chartsContainer">
                    <iframe id="chart1" width="100%" height="260" style="border: 1px solid var(--border); border-radius: 12px; margin-bottom: 1rem;" src="about:blank"></iframe>
                    <iframe id="chart2" width="100%" height="260" style="border: 1px solid var(--border); border-radius: 12px; margin-bottom: 1rem;" src="about:blank"></iframe>
                    <iframe id="chart3" width="100%" height="260" style="border: 1px solid var(--border); border-radius: 12px;" src="about:blank"></iframe>
                </div>
            </div>

            <div class="text-center mt-4">
                <button class="btn btn-success btn-lg me-2" onclick="loadThingSpeakData()">
                    <i class="fas fa-sync-alt me-2"></i>Refresh Data
                </button>
                <button class="btn btn-primary btn-lg" onclick="exportData()">
                    <i class="fas fa-download me-2"></i>Export Report
                </button>
            </div>
        </div>
    </section>

    <section id="emergency" style="display:none;">
        <div class="container">
            <h2 class="section-title">Emergency Contacts</h2>
            <p class="lead mb-5 text-muted">In case of emergency, contact these numbers immediately. Help is just a call away.</p>
            
            <div class="row g-4">
                <div class="col-lg-6">
                    <div class="contact-card">
                        <div class="contact-icon">
                            <i class="fas fa-phone-alt"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h5 class="mb-2">National Emergency</h5>
                            <h2 class="mb-1" style="color: var(--primary);">112</h2>
                            <small class="text-muted">24/7 All Emergency Services</small>
                        </div>
                        <a href="tel:112" class="btn btn-primary">
                            <i class="fas fa-phone"></i>
                        </a>
                    </div>

                    <div class="contact-card">
                        <div class="contact-icon" style="background: linear-gradient(135deg, #ef4444, #dc2626);">
                            <i class="fas fa-ambulance"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h5 class="mb-2">Ambulance</h5>
                            <h2 class="mb-1 text-danger">108</h2>
                            <small class="text-muted">Medical Emergency</small>
                        </div>
                        <a href="tel:108" class="btn btn-danger">
                            <i class="fas fa-phone"></i>
                        </a>
                    </div>

                    <div class="contact-card">
                        <div class="contact-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                            <i class="fas fa-fire"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h5 class="mb-2">Fire Department</h5>
                            <h2 class="mb-1 text-warning">101</h2>
                            <small class="text-muted">Fire & Rescue Services</small>
                        </div>
                        <a href="tel:101" class="btn btn-warning">
                            <i class="fas fa-phone"></i>
                        </a>
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="contact-card">
                        <div class="contact-icon" style="background: linear-gradient(135deg, #0f172a, #334155);">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h5 class="mb-2">Police</h5>
                            <h2 class="mb-1" style="color: #0f172a;">100</h2>
                            <small class="text-muted">Law Enforcement</small>
                        </div>
                        <a href="tel:100" class="btn btn-dark">
                            <i class="fas fa-phone"></i>
                        </a>
                    </div>

                    <div class="contact-card">
                        <div class="contact-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                            <i class="fas fa-hospital"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h5 class="mb-2">Disaster Management</h5>
                            <h2 class="mb-1 text-success">1070</h2>
                            <small class="text-muted">NDRF Emergency</small>
                        </div>
                        <a href="tel:1070" class="btn btn-success">
                            <i class="fas fa-phone"></i>
                        </a>
                    </div>

                    <div class="contact-card">
                        <div class="contact-icon" style="background: linear-gradient(135deg, #3b82f6, #2563eb);">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h5 class="mb-2">Local Authority</h5>
                            <h5 class="mb-1" style="color: #3b82f6;" id="localContact">+91-XXXXXXXXXX</h5>
                            <small class="text-muted">District Emergency Control</small>
                        </div>
                        <button class="btn btn-info" onclick="editLocalContact()">
                            <i class="fas fa-edit"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="text-center mt-5">
                <button class="btn btn-danger btn-lg px-5 py-3" onclick="triggerEmergency()" style="font-size: 1.3rem;">
                    <i class="fas fa-exclamation-triangle me-2"></i>SEND EMERGENCY SOS ALERT
                </button>
                <p class="mt-3 text-muted">This will immediately alert authorities with your current location</p>
            </div>

            <div class="alert alert-warning mt-5 border-0 shadow-sm" role="alert" style="border-radius: 16px;">
                <h5 class="alert-heading"><i class="fas fa-info-circle me-2"></i>Important Safety Tips</h5>
                <hr>
                <ul class="mb-0">
                    <li>Keep your phone charged at all times</li>
                    <li>Save these emergency numbers in your contacts</li>
                    <li>Know your nearest evacuation routes and safe zones</li>
                    <li>Keep an emergency kit ready with water, food, and first aid</li>
                    <li>Share your location with family members regularly</li>
                </ul>
            </div>
        </div>
    </section>

    <section id="preparedness" style="display:none;">
        <div class="container">
            <h2 class="section-title">Disaster Preparedness & Safety Guidelines</h2>
            <p class="lead mb-5 text-muted">Learn how to stay safe before, during, and after a landslide. Knowledge saves lives.</p>
            
            <div class="row g-4">
                <div class="col-lg-6">
                    <div class="resource-card">
                        <h4><i class="fas fa-exclamation-circle text-danger me-2"></i>Before a Landslide</h4>
                        <ul>
                            <li>Stay alert to weather forecasts and landslide warnings</li>
                            <li>Prepare an emergency kit with water, food, and first aid supplies</li>
                            <li>Create an evacuation plan and practice it with family members</li>
                            <li>Keep important documents in waterproof containers</li>
                            <li>Know the evacuation routes and safe zones in your area</li>
                            <li>Avoid building near steep slopes or erosion-prone areas</li>
                            <li>Plant ground cover on slopes to reduce erosion</li>
                            <li>Install flexible pipe fittings to prevent gas or water leaks</li>
                        </ul>
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="resource-card">
                        <h4><i class="fas fa-bolt text-warning me-2"></i>During a Landslide</h4>
                        <ul>
                            <li>Move away from the path of the landslide immediately</li>
                            <li>If escape is not possible, curl into a tight ball and protect your head</li>
                            <li>Stay alert for flooding which may follow a landslide</li>
                            <li>Listen for unusual sounds indicating moving debris</li>
                            <li>Evacuate if instructed by authorities - do not delay</li>
                            <li>Move to high ground or higher floors if possible</li>
                            <li>Stay away from rivers and low-lying areas</li>
                            <li>If indoors, stay inside and get under a desk or sturdy table</li>
                        </ul>
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="resource-card">
                        <h4><i class="fas fa-check-circle text-success me-2"></i>After a Landslide</h4>
                        <ul>
                            <li>Stay away from the slide area - additional slides may occur</li>
                            <li>Check for injured and trapped persons near the slide area</li>
                            <li>Watch for flooding and damaged infrastructure</li>
                            <li>Report broken utility lines to authorities immediately</li>
                            <li>Replant damaged ground as soon as possible</li>
                            <li>Seek professional advice before returning home</li>
                            <li>Watch for associated dangers like broken electrical lines</li>
                            <li>Allow authorities to inspect buildings before entering</li>
                        </ul>
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="resource-card">
                        <h4><i class="fas fa-box text-info me-2"></i>Emergency Kit Essentials</h4>
                        <ul>
                            <li>Water (1 gallon per person per day for 3 days)</li>
                            <li>Non-perishable food supply for at least 3 days</li>
                            <li>Flashlight and extra batteries</li>
                            <li>First aid kit and essential medications</li>
                            <li>Battery-powered or hand-crank radio</li>
                            <li>Important documents (ID, insurance, medical records)</li>
                            <li>Cash and credit cards</li>
                            <li>Whistle to signal for help</li>
                            <li>Dust masks and plastic sheeting</li>
                            <li>Moist towelettes, garbage bags, and plastic ties</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="resource-card mt-4">
                <h4><i class="fas fa-info-circle text-primary me-2"></i>Warning Signs of an Imminent Landslide</h4>
                <p class="text-muted mb-4">Watch for these signs that indicate a landslide may occur soon:</p>
                <div class="row">
                    <div class="col-md-6">
                        <ul>
                            <li>Changes in landscape patterns (land movement)</li>
                            <li>Doors or windows sticking or jamming for the first time</li>
                            <li>New cracks in plaster, tile, brick, or foundations</li>
                            <li>Broken water lines or leaking pipes</li>
                            <li>Sunken or down-dropped road beds</li>
                            <li>Tilting or cracking of concrete floors and foundations</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <ul>
                            <li>Bulging ground at the base of a slope</li>
                            <li>Rapid increase in creek water levels with debris</li>
                            <li>Sudden decrease in creek water (may indicate blockage)</li>
                            <li>Sticking doors and windows with visible gaps</li>
                            <li>Underground utility lines breaking</li>
                            <li>Fences, retaining walls, utility poles tilting or moving</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="resource-card mt-4" style="background: linear-gradient(135deg, #f0f9ff, white);">
                <h4><i class="fas fa-book text-primary me-2"></i>Additional Resources</h4>
                <div class="row">
                    <div class="col-md-4">
                        <h6 class="fw-bold mb-3">Government Resources</h6>
                        <ul class="list-unstyled">
                            <li class="mb-2"><a href="https://ndma.gov.in" target="_blank" class="text-decoration-none"><i class="fas fa-external-link-alt me-2"></i>NDMA India</a></li>
                            <li class="mb-2"><a href="https://ndrf.gov.in" target="_blank" class="text-decoration-none"><i class="fas fa-external-link-alt me-2"></i>NDRF</a></li>
                            <li class="mb-2"><a href="#" class="text-decoration-none"><i class="fas fa-external-link-alt me-2"></i>State Disaster Management</a></li>
                        </ul>
                    </div>
                    <div class="col-md-4">
                        <h6 class="fw-bold mb-3">Safety Guidelines</h6>
                        <ul class="list-unstyled">
                            <li class="mb-2"><a href="#" class="text-decoration-none"><i class="fas fa-file-pdf me-2"></i>Landslide Safety Manual</a></li>
                            <li class="mb-2"><a href="#" class="text-decoration-none"><i class="fas fa-file-pdf me-2"></i>Family Emergency Plan</a></li>
                            <li class="mb-2"><a href="#" class="text-decoration-none"><i class="fas fa-file-pdf me-2"></i>Evacuation Routes Map</a></li>
                        </ul>
                    </div>
                    <div class="col-md-4">
                        <h6 class="fw-bold mb-3">Training & Education</h6>
                        <ul class="list-unstyled">
                            <li class="mb-2"><a href="#" class="text-decoration-none"><i class="fas fa-video me-2"></i>Safety Training Videos</a></li>
                            <li class="mb-2"><a href="#" class="text-decoration-none"><i class="fas fa-video me-2"></i>First Aid Tutorials</a></li>
                            <li class="mb-2"><a href="#" class="text-decoration-none"><i class="fas fa-video me-2"></i>Community Workshops</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="location" style="display:none;">
        <div class="container">
            <h2 class="section-title">Real-Time Location Monitoring</h2>
            
            <div class="row g-4">
                <div class="col-lg-8">
                    <div id="map"></div>
                </div>
                <div class="col-lg-4">
                    <div class="sensor-card">
                        <h4 class="mb-4"><i class="fas fa-map-marker-alt text-danger me-2"></i>Current Location</h4>
                        <div class="mb-3">
                            <strong class="d-block text-muted mb-1">Latitude</strong>
                            <span id="latitude" class="h5" style="color: var(--primary);">Loading...</span>
                        </div>
                        <div class="mb-3">
                            <strong class="d-block text-muted mb-1">Longitude</strong>
                            <span id="longitude" class="h5" style="color: var(--primary);">Loading...</span>
                        </div>
                        <div class="mb-4">
                            <strong class="d-block text-muted mb-1">Address</strong>
                            <span id="address" class="text-muted">Loading...</span>
                        </div>
                        <button class="btn btn-primary w-100 mb-2" onclick="updateLocation()">
                            <i class="fas fa-sync me-2"></i>Refresh Location
                        </button>
                        <button class="btn btn-success w-100" onclick="shareLocation()">
                            <i class="fas fa-share-alt me-2"></i>Share Location
                        </button>
                    </div>

                    <div class="sensor-card mt-3">
                        <h5 class="mb-3"><i class="fas fa-clock me-2"></i>Last Updated</h5>
                        <p id="lastUpdate" class="text-muted mb-3">Not updated yet</p>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="autoUpdate" checked>
                            <label class="form-check-label" for="autoUpdate">
                                Auto-refresh every 30 seconds
                            </label>
                        </div>
                    </div>

                    <div class="sensor-card mt-3">
                        <h5 class="mb-3"><i class="fas fa-map me-2"></i>Nearby Safe Zones</h5>
                        <ul class="list-unstyled">
                            <li class="mb-2 d-flex align-items-center">
                                <i class="fas fa-check-circle text-success me-2"></i>
                                <span>Community Center - 2.3 km</span>
                            </li>
                            <li class="mb-2 d-flex align-items-center">
                                <i class="fas fa-check-circle text-success me-2"></i>
                                <span>District Hospital - 3.7 km</span>
                            </li>
                            <li class="d-flex align-items-center">
                                <i class="fas fa-check-circle text-success me-2"></i>
                                <span>Police Station - 1.8 km</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-user-circle me-2"></i>Login to Slide Sense</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="loginForm">
                        <div class="mb-3">
                            <label class="form-label fw-semibold">Email Address</label>
                            <input type="email" class="form-control" id="email" required placeholder="your@email.com">
                        </div>
                        <div class="mb-3">
                            <label class="form-label fw-semibold">Password</label>
                            <input type="password" class="form-control" id="password" required placeholder="Enter your password">
                        </div>
                        <div class="form-check mb-4">
                            <input class="form-check-input" type="checkbox" id="rememberMe">
                            <label class="form-check-label" for="rememberMe">
                                Remember me
                            </label>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">
                            <i class="fas fa-sign-in-alt me-2"></i>Login
                        </button>
                    </form>
                    <div class="text-center mt-3">
                        <small class="text-muted">Don't have an account? <a href="#" data-bs-dismiss="modal" data-bs-toggle="modal" data-bs-target="#signupModal">Sign up</a></small>
                    </div>
                    <hr class="my-4">
                    <div class="text-center">
                        <small class="text-muted">By logging in, you'll receive real-time landslide alerts via email</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="signupModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-user-plus me-2"></i>Create Account</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="signupForm">
                        <div class="mb-3">
                            <label class="form-label fw-semibold">Full Name</label>
                            <input type="text" class="form-control" id="signupName" required placeholder="John Doe">
                        </div>
                        <div class="mb-3">
                            <label class="form-label fw-semibold">Email Address</label>
                            <input type="email" class="form-control" id="signupEmail" required placeholder="your@email.com">
                        </div>
                        <div class="mb-3">
                            <label class="form-label fw-semibold">Phone Number</label>
                            <input type="tel" class="form-control" id="signupPhone" required placeholder="+91 1234567890">
                        </div>
                        <div class="mb-3">
                            <label class="form-label fw-semibold">Password</label>
                            <input type="password" class="form-control" id="signupPassword" required placeholder="Create a strong password">
                        </div>
                        <div class="form-check mb-4">
                            <input class="form-check-input" type="checkbox" id="agreeTerms" required>
                            <label class="form-check-label" for="agreeTerms">
                                I agree to receive emergency alerts and notifications
                            </label>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">
                            <i class="fas fa-user-plus me-2"></i>Create Account
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="row g-4">
                <div class="col-lg-4 footer-section">
                    <h5>About Slide Sense</h5>
                    <p>An intelligent IoT-based landslide detection and early warning system designed to save lives through real-time monitoring, cloud analytics, and instant alerts.</p>
                    <p class="mt-3"><strong>Powered by:</strong></p>
                    <p class="mb-0">Raspberry Pi Pico W â€¢ ThingSpeak Cloud â€¢ Advanced Sensors</p>
                </div>
                <div class="col-lg-4 footer-section">
                    <h5>Quick Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" onclick="showSection('home')">Home</a></li>
                        <li><a href="#" onclick="showSection('dashboard')">Dashboard</a></li>
                        <li><a href="#" onclick="showSection('emergency')">Emergency Contacts</a></li>
                        <li><a href="#" onclick="showSection('preparedness')">Safety Guidelines</a></li>
                        <li><a href="#" onclick="showSection('location')">Location Tracking</a></li>
                    </ul>
                </div>
                <div class="col-lg-4 footer-section">
                    <h5>Contact Us</h5>
                    <p><i class="fas fa-envelope me-2"></i>info@slidesense.com</p>
                    <p><i class="fas fa-phone me-2"></i>+91 1234567890</p>
                    <p><i class="fas fa-map-marker-alt me-2"></i>Nagpur, Maharashtra, India</p>
                    <div class="mt-4">
                        <a href="#" class="text-white me-3"><i class="fab fa-facebook fa-lg"></i></a>
                        <a href="#" class="text-white me-3"><i class="fab fa-twitter fa-lg"></i></a>
                        <a href="#" class="text-white me-3"><i class="fab fa-linkedin fa-lg"></i></a>
                        <a href="#" class="text-white"><i class="fab fa-github fa-lg"></i></a>
                    </div>
                </div>
            </div>
            <hr style="border-color: rgba(255,255,255,0.1); margin: 3rem 0 2rem;">
            <div class="row">
                <div class="col-md-6 text-center text-md-start">
                    <p class="mb-0">&copy; 2024 Slide Sense. All rights reserved.</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <p class="mb-0">Developed with â¤ï¸ for disaster prevention and public safety</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const CONFIG = {
            thingSpeakChannelId: '3100704',
            thingSpeakReadAPIKey: 'G0WEYRWOLP7LAG8E',
            emailJSServiceId: 'YOUR_EMAILJS_SERVICE_ID',
            emailJSTemplateId: 'YOUR_EMAILJS_TEMPLATE_ID',
            emailJSPublicKey: 'YOUR_EMAILJS_PUBLIC_KEY'
        };

        let currentUser = null;
        let updateInterval = null;
        let userLocation = { lat: 21.1458, lng: 79.0882 };
        let map = null;
        let marker = null;

        const THRESHOLDS = {
            soilMoisture: { warning: 60, danger: 80 },
            temperature: { warning: 35, danger: 40 },
            acceleration: { warning: 2, danger: 5 },
            gasLevel: { warning: 300, danger: 500 },
            vibration: { warning: 50, danger: 80 },
            rain: { warning: 40, danger: 70 }
        };

        document.addEventListener('DOMContentLoaded', function() {
            const savedUser = JSON.parse(localStorage.getItem('slideSenseUser') || 'null');
            if (savedUser) {
                currentUser = savedUser;
                updateLoginButton();
            }

            updateLocation();
            startAutoRefresh();

            if (CONFIG.thingSpeakChannelId) {
                loadThingSpeakData();
            } else {
                generateDemoData();
                setInterval(generateDemoData, 10000);
            }
        });

        function showSection(sectionId) {
            document.querySelectorAll('section').forEach(section => {
                section.style.display = 'none';
            });

            const section = document.getElementById(sectionId);
            if (section) {
                section.style.display = 'block';
                
                if (sectionId === 'location' && !map) {
                    setTimeout(initMap, 100);
                }
                
                if (sectionId === 'home') {
                    document.getElementById('features').style.display = 'block';
                }
            }

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            currentUser = { 
                email: email, 
                name: email.split('@')[0],
                loginTime: new Date().toISOString()
            };
            
            if (document.getElementById('rememberMe').checked) {
                localStorage.setItem('slideSenseUser', JSON.stringify(currentUser));
            }

            const modal = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
            modal.hide();

            updateLoginButton();

            showNotification('âœ… Login successful! You will now receive landslide alerts via email.', 'success');
        });

        document.getElementById('signupForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const phone = document.getElementById('signupPhone').value;

            currentUser = { 
                name: name,
                email: email,
                phone: phone,
                signupTime: new Date().toISOString()
            };
            
            localStorage.setItem('slideSenseUser', JSON.stringify(currentUser));

            const modal = bootstrap.Modal.getInstance(document.getElementById('signupModal'));
            modal.hide();

            updateLoginButton();

            showNotification('âœ… Account created successfully! Welcome to Slide Sense.', 'success');
        });

        function updateLoginButton() {
            const loginBtn = document.querySelector('.btn-login');
            if (currentUser) {
                loginBtn.innerHTML = `<i class="fas fa-user me-2"></i>${currentUser.name}`;
                loginBtn.onclick = logout;
                loginBtn.setAttribute('data-bs-toggle', '');
                loginBtn.setAttribute('data-bs-target', '');
            }
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                currentUser = null;
                localStorage.removeItem('slideSenseUser');
                location.reload();
            }
        }

        async function loadThingSpeakData() {
            const channelId = CONFIG.thingSpeakChannelId || document.getElementById('channelId').value;
            const apiKey = CONFIG.thingSpeakReadAPIKey || document.getElementById('readApiKey').value;

            if (!channelId) {
                return;
            }

            try {
                const url = `https://api.thingspeak.com/channels/${channelId}/feeds.json?api_key=${apiKey}&results=1`;
                const response = await fetch(url);
                const data = await response.json();

                if (data.feeds && data.feeds.length > 0) {
                    const latest = data.feeds[0];
                    
                    updateSensorDisplay('soilMoisture', latest.field1, '%');
                    updateSensorDisplay('temperature', latest.field2, 'Â°C');
                    document.getElementById('humidity').textContent = parseFloat(latest.field3).toFixed(1) + '%';
                    updateSensorDisplay('acceleration', latest.field4, 'g');
                    updateSensorDisplay('gasLevel', latest.field5, 'ppm');
                    updateSensorDisplay('distance', latest.field6, 'cm');
                    updateSensorDisplay('vibration', latest.field7, 'units');
                    updateSensorDisplay('rainLevel', latest.field8, '%');

                    calculateRiskLevel({
                        soil: parseFloat(latest.field1 || 0),
                        temp: parseFloat(latest.field2 || 0),
                        accel: parseFloat(latest.field4 || 0),
                        gas: parseFloat(latest.field5 || 0),
                        vibration: parseFloat(latest.field7 || 0),
                        rain: parseFloat(latest.field8 || 0)
                    });

                    updateStatusMessages();
                }
            } catch (error) {
                console.error('Error fetching ThingSpeak data:', error);
                generateDemoData();
            }
        }

        function updateSensorDisplay(elementId, value, unit) {
            const element = document.getElementById(elementId);
            if (element && value !== undefined && value !== null) {
                element.textContent = parseFloat(value).toFixed(1) + unit;
            }
        }

        function loadThingSpeakCharts() {
            const channelId = document.getElementById('channelId').value || CONFIG.thingSpeakChannelId;
            
            if (!channelId) {
                showNotification('âš ï¸ Please enter a ThingSpeak Channel ID', 'warning');
                return;
            }

            document.getElementById('chart1').src = `https://thingspeak.com/channels/${channelId}/charts/1?bgcolor=%23ffffff&color=%236366f1&dynamic=true&results=60&type=line&title=Soil+Moisture`;
            document.getElementById('chart2').src = `https://thingspeak.com/channels/${channelId}/charts/2?bgcolor=%23ffffff&color=%23ef4444&dynamic=true&results=60&type=line&title=Temperature`;
            document.getElementById('chart3').src = `https://thingspeak.com/channels/${channelId}/charts/4?bgcolor=%23ffffff&color=%23f59e0b&dynamic=true&results=60&type=line&title=Acceleration`;

            showNotification('âœ… Charts loaded successfully!', 'success');
        }

        function calculateRiskLevel(readings) {
            let riskScore = 0;
            let riskFactors = [];

            if (readings.soil > THRESHOLDS.soilMoisture.danger) {
                riskScore += 30;
                riskFactors.push('Critical soil moisture');
            } else if (readings.soil > THRESHOLDS.soilMoisture.warning) {
                riskScore += 15;
                riskFactors.push('High soil moisture');
            }

            if (readings.accel > THRESHOLDS.acceleration.danger) {
                riskScore += 25;
                riskFactors.push('High ground movement');
            } else if (readings.accel > THRESHOLDS.acceleration.warning) {
                riskScore += 12;
                riskFactors.push('Ground movement detected');
            }

            if (readings.vibration > THRESHOLDS.vibration.danger) {
                riskScore += 20;
                riskFactors.push('Critical vibration levels');
            } else if (readings.vibration > THRESHOLDS.vibration.warning) {
                riskScore += 10;
                riskFactors.push('Elevated vibration');
            }

            if (readings.rain > THRESHOLDS.rain.danger) {
                riskScore += 15;
                riskFactors.push('Heavy rainfall');
            } else if (readings.rain > THRESHOLDS.rain.warning) {
                riskScore += 8;
                riskFactors.push('Moderate rainfall');
            }

            if (readings.gas > THRESHOLDS.gasLevel.danger) {
                riskScore += 10;
                riskFactors.push('High gas levels');
            }

            const riskIndicator = document.getElementById('riskIndicator');
            const riskMeterFill = document.getElementById('riskMeterFill');
            const riskLevel = document.getElementById('riskLevel');
            const riskBadge = document.getElementById('riskBadge');
            const riskDescription = document.getElementById('riskDescription');

            const indicatorPosition = Math.min(riskScore, 100);
            riskIndicator.style.left = `calc(${indicatorPosition}% - 12px)`;
            riskMeterFill.style.width = `${indicatorPosition}%`;

            if (riskScore >= 70) {
                riskLevel.textContent = 'CRITICAL RISK';
                riskBadge.textContent = 'DANGER - EVACUATE NOW';
                riskBadge.className = 'status-badge status-danger';
                riskDescription.textContent = 'Immediate evacuation required! ' + riskFactors.join(', ');
                
                showAlert('ðŸš¨ CRITICAL: High landslide risk detected! Evacuate immediately!');
                
                if (currentUser) {
                    sendEmailAlert(currentUser.email, 'CRITICAL', riskScore, riskFactors);
                }
            } else if (riskScore >= 40) {
                riskLevel.textContent = 'ELEVATED RISK';
                riskBadge.textContent = 'WARNING - STAY ALERT';
                riskBadge.className = 'status-badge status-warning';
                riskDescription.textContent = 'Stay alert and prepared. ' + (riskFactors.length > 0 ? riskFactors.join(', ') : 'Monitor conditions closely');
                
                showAlert('âš ï¸ Warning: Elevated landslide risk. Stay alert and prepared!');
            } else {
                riskLevel.textContent = 'LOW RISK';
                riskBadge.textContent = 'SAFE';
                riskBadge.className = 'status-badge status-safe';
                riskDescription.textContent = 'All parameters within normal range. Monitoring continues.';
                
                hideAlert();
            }
        }

        function updateStatusMessages() {
            const soil = parseFloat(document.getElementById('soilMoisture').textContent);
            const soilCard = document.getElementById('soilCard');
            if (soil > THRESHOLDS.soilMoisture.danger) {
                document.getElementById('soilStatus').textContent = 'âŒ Critical';
                soilCard.classList.add('danger');
            } else if (soil > THRESHOLDS.soilMoisture.warning) {
                document.getElementById('soilStatus').textContent = 'âš ï¸ Warning';
                soilCard.classList.add('warning');
            } else {
                document.getElementById('soilStatus').textContent = 'âœ… Normal';
                soilCard.classList.remove('danger', 'warning');
            }

            const accel = parseFloat(document.getElementById('acceleration').textContent);
            const accelCard = document.getElementById('accelCard');
            if (accel > THRESHOLDS.acceleration.danger) {
                document.getElementById('accelStatus').textContent = 'âŒ Critical';
                accelCard.classList.add('danger');
            } else if (accel > THRESHOLDS.acceleration.warning) {
                document.getElementById('accelStatus').textContent = 'âš ï¸ Warning';
                accelCard.classList.add('warning');
            } else {
                document.getElementById('accelStatus').textContent = 'âœ… Normal';
                accelCard.classList.remove('danger', 'warning');
            }

            const vibration = parseFloat(document.getElementById('vibration').textContent);
            const vibrationCard = document.getElementById('vibrationCard');
            if (vibration > THRESHOLDS.vibration.danger) {
                document.getElementById('vibrationStatus').textContent = 'âŒ Critical';
                vibrationCard.classList.add('danger');
            } else if (vibration > THRESHOLDS.vibration.warning) {
                document.getElementById('vibrationStatus').textContent = 'âš ï¸ Warning';
                vibrationCard.classList.add('warning');
            } else {
                document.getElementById('vibrationStatus').textContent = 'âœ… Normal';
                vibrationCard.classList.remove('danger', 'warning');
            }

            const rain = parseFloat(document.getElementById('rainLevel').textContent);
            const rainCard = document.getElementById('rainCard');
            if (rain > THRESHOLDS.rain.danger) {
                document.getElementById('rainStatus').textContent = 'ðŸŒ§ï¸ Heavy Rain';
                rainCard.classList.add('danger');
            } else if (rain > THRESHOLDS.rain.warning) {
                document.getElementById('rainStatus').textContent = 'â˜ï¸ Moderate';
                rainCard.classList.add('warning');
            } else {
                document.getElementById('rainStatus').textContent = 'â˜€ï¸ No Rain';
                rainCard.classList.remove('danger', 'warning');
            }

            const gas = parseFloat(document.getElementById('gasLevel').textContent);
            const gasCard = document.getElementById('gasCard');
            if (gas > THRESHOLDS.gasLevel.danger) {
                document.getElementById('gasStatus').textContent = 'âŒ High';
                gasCard.classList.add('danger');
            } else if (gas > THRESHOLDS.gasLevel.warning) {
                document.getElementById('gasStatus').textContent = 'âš ï¸ Elevated';
                gasCard.classList.add('warning');
            } else {
                document.getElementById('gasStatus').textContent = 'âœ… Normal';
                gasCard.classList.remove('danger', 'warning');
            }
        }

        function showAlert(message) {
            const banner = document.getElementById('alertBanner');
            document.getElementById('alertMessage').textContent = message;
            banner.classList.add('active');
        }

        function hideAlert() {
            document.getElementById('alertBanner').classList.remove('active');
        }

        function sendEmailAlert(email, severity, riskScore, riskFactors) {
            const alertData = {
        to_email: email,
        severity: severity,
        risk_score: riskScore,
        timestamp: new Date().toLocaleString(),
        location: `Lat: ${userLocation.lat.toFixed(6)}, Lng: ${userLocation.lng.toFixed(6)}`,
        risk_factors: riskFactors.join(', '),
        message: `Landslide alert: ${severity} risk detected (Score: ${riskScore}/100). Risk factors: ${riskFactors.join(', ')}. Please take precautions immediately.`
        };

        fetch("/api/alert", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "x-alert-token": "YOUR_SECRET_KEY"
        },
        body: JSON.stringify(alertData)
        })
        .then(res => res.json())
        .then(data => console.log("ðŸ“§ Alert sent:", data))
        .catch(err => console.error("Error sending alert:", err));
         }

        function updateLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    position => {
                        userLocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        
                        document.getElementById('latitude').textContent = userLocation.lat.toFixed(6);
                        document.getElementById('longitude').textContent = userLocation.lng.toFixed(6);
                        document.getElementById('lastUpdate').textContent = new Date().toLocaleString();
                        document.getElementById('address').textContent = `Coordinates: ${userLocation.lat.toFixed(4)}, ${userLocation.lng.toFixed(4)}`;
                        
                        if (map) {
                            updateMapMarker();
                        }
                    },
                    error => {
                        console.error('Geolocation error:', error);
                        document.getElementById('address').textContent = 'Location access denied or unavailable';
                    }
                );
            }
        }

        function initMap() {
            if (map) {
                map.remove();
            }

            map = L.map('map').setView([userLocation.lat, userLocation.lng], 13);

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© OpenStreetMap contributors',
                maxZoom: 19
            }).addTo(map);

            marker = L.marker([userLocation.lat, userLocation.lng])
                .addTo(map)
                .bindPopup('<b>Your Location</b><br>Monitoring active')
                .openPopup();

            L.circle([userLocation.lat, userLocation.lng], {
                color: '#ef4444',
                fillColor: '#ef4444',
                fillOpacity: 0.15,
                radius: 1000
            }).addTo(map).bindPopup('Risk Monitoring Zone - 1km radius');
        }

        function updateMapMarker() {
            if (marker && map) {
                marker.setLatLng([userLocation.lat, userLocation.lng]);
                map.setView([userLocation.lat, userLocation.lng], 13);
            }
        }

        function shareLocation() {
            const locationText = `My current location: https://www.google.com/maps?q=${userLocation.lat},${userLocation.lng}`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'My Location - Slide Sense',
                    text: locationText
                }).then(() => {
                    showNotification('âœ… Location shared successfully!', 'success');
                }).catch(err => {
                    copyToClipboard(locationText);
                });
            } else {
                copyToClipboard(locationText);
            }
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showNotification('âœ… Location copied to clipboard!', 'success');
            }).catch(err => {
                showNotification('âŒ Failed to copy location', 'danger');
            });
        }

        function startAutoRefresh() {
            if (updateInterval) clearInterval(updateInterval);
            
            updateInterval = setInterval(() => {
                if (document.getElementById('autoUpdate').checked) {
                    loadThingSpeakData();
                    updateLocation();
                }
            }, 30000);
        }

        function triggerEmergency() {
            if (confirm('âš ï¸ Are you sure you want to send an EMERGENCY ALERT?\n\nThis will notify:\nâ€¢ Emergency Services (112)\nâ€¢ Disaster Management (NDRF)\nâ€¢ Local Authorities\n\nYour location will be shared immediately.')) {
                
                const emergencyData = {
                    user: currentUser ? currentUser.name : 'Anonymous User',
                    email: currentUser ? currentUser.email : 'N/A',
                    location: `${userLocation.lat}, ${userLocation.lng}`,
                    timestamp: new Date().toISOString(),
                    type: 'Landslide Emergency SOS'
                };

                console.log('ðŸš¨ EMERGENCY ALERT:', emergencyData);
                
                showNotification('ðŸš¨ EMERGENCY ALERT SENT!\n\nâœ… Authorities notified\nâœ… Location shared\nâœ… Help is on the way', 'danger');
                
                if (currentUser) {
                    sendEmailAlert(currentUser.email, 'EMERGENCY', 100, ['Manual SOS trigger']);
                }
            }
        }

        function editLocalContact() {
            const newContact = prompt('Enter local district emergency contact number:', document.getElementById('localContact').textContent);
            if (newContact) {
                document.getElementById('localContact').textContent = newContact;
                localStorage.setItem('localEmergencyContact', newContact);
                showNotification('âœ… Local contact updated successfully!', 'success');
            }
        }

        function exportData() {
            const exportData = {
                timestamp: new Date().toISOString(),
                user: currentUser ? currentUser.name : 'Guest',
                location: userLocation,
                sensors: {
                    soilMoisture: document.getElementById('soilMoisture').textContent,
                    temperature: document.getElementById('temperature').textContent,
                    humidity: document.getElementById('humidity').textContent,
                    acceleration: document.getElementById('acceleration').textContent,
                    gasLevel: document.getElementById('gasLevel').textContent,
                    distance: document.getElementById('distance').textContent,
                    vibration: document.getElementById('vibration').textContent,
                    rainLevel: document.getElementById('rainLevel').textContent
                },
                riskLevel: document.getElementById('riskLevel').textContent,
                riskBadge: document.getElementById('riskBadge').textContent
            };

            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `slide-sense-report-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            showNotification('âœ… Report exported successfully!', 'success');
        }

        function generateDemoData() {
            const demoData = {
                soil: 30 + Math.random() * 60,
                temp: 20 + Math.random() * 20,
                humidity: 40 + Math.random() * 40,
                accel: Math.random() * 4,
                gas: 100 + Math.random() * 400,
                distance: 10 + Math.random() * 190,
                vibration: Math.random() * 70,
                rain: Math.random() * 80
            };

            updateSensorDisplay('soilMoisture', demoData.soil, '%');
            updateSensorDisplay('temperature', demoData.temp, 'Â°C');
            document.getElementById('humidity').textContent = demoData.humidity.toFixed(1) + '%';
            updateSensorDisplay('acceleration', demoData.accel, 'g');
            updateSensorDisplay('gasLevel', demoData.gas, 'ppm');
            updateSensorDisplay('distance', demoData.distance, 'cm');
            updateSensorDisplay('vibration', demoData.vibration, 'units');
            updateSensorDisplay('rainLevel', demoData.rain, '%');

            calculateRiskLevel(demoData);
            updateStatusMessages();
        }

        function showNotification(message, type = 'info') {
            const alertClass = type === 'success' ? 'alert-success' : type === 'danger' ? 'alert-danger' : type === 'warning' ? 'alert-warning' : 'alert-info';
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert ${alertClass} position-fixed top-0 start-50 translate-middle-x mt-3 shadow-lg`;
            alertDiv.style.zIndex = '9999';
            alertDiv.style.minWidth = '300px';
            alertDiv.innerHTML = message.replace(/\n/g, '<br>');
            document.body.appendChild(alertDiv);
            
            setTimeout(() => {
                alertDiv.style.transition = 'opacity 0.5s';
                alertDiv.style.opacity = '0';
                setTimeout(() => alertDiv.remove(), 500);
            }, 3000);
        }

        const savedContact = localStorage.getItem('localEmergencyContact');
        if (savedContact) {
            document.getElementById('localContact').textContent = savedContact;
        }

        if (!CONFIG.thingSpeakChannelId) {
            console.log('â„¹ï¸ Running in demo mode - generating simulated sensor data');
        }

        showSection('home');
    </script>
</body>
</html>